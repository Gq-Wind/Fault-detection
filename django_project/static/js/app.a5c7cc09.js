(function(){"use strict";var e={1369:function(e,t,a){var o=a(9197),r=a(8473);const s={class:""};function l(e,t,a,o,l,n){const u=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r.Wm)(u)])}var n={name:"App",components:{}},u=a(5312);const i=(0,u.Z)(n,[["render",l]]);var d=i,c=a(4731),m=a(4887),p=a.p+"static/img/logo.18e064fb.png";const f=e=>((0,r.dD)("data-v-b0a48e14"),e=e(),(0,r.Cn)(),e),g={class:"loginpage"},w={class:"login"},h=f((()=>(0,r._)("img",{src:p,alt:""},null,-1))),v={class:"topnav"},_={class:"form-group"},y={class:"form-group"},b={key:0,class:"tip2"},k=f((()=>(0,r._)("button",{class:"login-btn",type:"submit"},"登录",-1)));function C(e,t,a,s,l,n){const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",g,[(0,r._)("div",w,[(0,r.Wm)(u,{to:"/",class:"logo"},{default:(0,r.w5)((()=>[h])),_:1}),(0,r._)("div",v,[(0,r.Wm)(u,{to:"/about",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("文档")])),_:1}),(0,r.Wm)(u,{to:"/register",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("注册")])),_:1}),(0,r.Wm)(u,{to:"/",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("首页")])),_:1})]),(0,r._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)((function(){return e.login&&e.login(...arguments)}),["prevent"]))},[(0,r._)("div",_,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.username=t),placeholder:"用户名"},null,512),[[o.nr,e.username]])]),(0,r._)("div",y,[(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),placeholder:"密码"},null,512),[[o.nr,e.password]]),e.errorMessage?((0,r.wg)(),(0,r.iD)("div",b,(0,m.zw)(e.errorMessage),1)):(0,r.kq)("",!0)]),k,(0,r._)("p",null,[(0,r.Uk)("没有账号？去"),(0,r.Wm)(u,{to:"/register",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)(" 注册")])),_:1})])],32)])])}a(7658);var W=a(4188),M=a(9868),U=a.n(M),D=(0,r.aZ)({setup(){const e=(0,W.iH)(""),t=(0,W.iH)(""),a=(0,W.iH)(""),o=new FormData,r=async()=>{try{o.append("username",e.value),o.append("password",t.value);const a=await U().post("user/login/",o),r=a.headers.authorization.split(" ")[1];localStorage.removeItem("username"),localStorage.removeItem("token"),localStorage.setItem("username",e.value),localStorage.setItem("token",r),bt.push({path:"/workspace"})}catch(r){const e=r.response.data.error_msg;a.value=e}};return{username:e,password:t,errorMessage:a,login:r}}});const N=(0,u.Z)(D,[["render",C],["__scopeId","data-v-b0a48e14"]]);var S=N;const P=e=>((0,r.dD)("data-v-3c0d47d2"),e=e(),(0,r.Cn)(),e),T={class:"homepage"},x={class:"home"},j=P((()=>(0,r._)("img",{src:p,alt:""},null,-1))),V={class:"topnav"},F=P((()=>(0,r._)("h1",null,"Startup",-1))),I=P((()=>(0,r._)("div",{class:"introduction"},[(0,r.Uk)(" 分布式故障分类系统，"),(0,r._)("br"),(0,r.Uk)(" 接入多种神经网络和机器学习分布式故障分类算法，"),(0,r._)("br"),(0,r.Uk)(" 也可训练自己的专属模型，更快更精准！ ")],-1)));function z(e,t){const a=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",T,[(0,r._)("div",x,[(0,r.Wm)(a,{to:"/",class:"logo"},{default:(0,r.w5)((()=>[j])),_:1}),(0,r._)("div",V,[(0,r.Wm)(a,{to:"/about",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("文档")])),_:1}),(0,r.Wm)(a,{to:"/register",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("注册")])),_:1}),(0,r.Wm)(a,{to:"/login",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("登录")])),_:1})]),F,I,(0,r.Wm)(a,{to:"/workspace",class:"login"},{default:(0,r.w5)((()=>[(0,r.Uk)("创建项目")])),_:1})])])}const O={},$=(0,u.Z)(O,[["render",z],["__scopeId","data-v-3c0d47d2"]]);var H=$;const Z=e=>((0,r.dD)("data-v-ee88959c"),e=e(),(0,r.Cn)(),e),q={class:"registerpage"},R={class:"register"},L=Z((()=>(0,r._)("img",{src:p,alt:""},null,-1))),A={class:"topnav"},B={class:"form-group"},Y={class:"form-group"},E={class:"form-group"},K={class:"form-group"},J=["src"],G=Z((()=>(0,r._)("button",{class:"register-btn",type:"submit"},"注册",-1)));function Q(e,t,a,s,l,n){const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",q,[(0,r._)("div",R,[(0,r.Wm)(u,{to:"/",class:"logo"},{default:(0,r.w5)((()=>[L])),_:1}),(0,r._)("div",A,[(0,r.Wm)(u,{to:"/about",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("文档")])),_:1}),(0,r.Wm)(u,{to:"/login",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("登录")])),_:1}),(0,r.Wm)(u,{to:"/",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("首页")])),_:1})]),(0,r._)("form",{onSubmit:t[5]||(t[5]=(0,o.iM)((function(){return e.onSubmit&&e.onSubmit(...arguments)}),["prevent"]))},[(0,r._)("div",B,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.username=t),placeholder:"输入用户名"},null,512),[[o.nr,e.username]]),(0,r.wy)((0,r._)("div",{class:"tip1"},(0,m.zw)(e.errors.username),513),[[o.F8,!e.validUsername]])]),(0,r._)("div",Y,[(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),placeholder:"输入登录密码"},null,512),[[o.nr,e.password]]),(0,r.wy)((0,r._)("div",{class:"tip2"},(0,m.zw)(e.errors.password),513),[[o.F8,!e.validPassword]])]),(0,r._)("div",E,[(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=t=>e.confirmPassword=t),placeholder:"再次输入登录密码"},null,512),[[o.nr,e.confirmPassword]]),(0,r.wy)((0,r._)("div",{class:"tip3"},(0,m.zw)(e.errors.confirmPassword),513),[[o.F8,""!==e.password&&""!==e.confirmPassword&&e.password!==e.confirmPassword]])]),(0,r._)("div",K,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=t=>e.securityCode=t),placeholder:"输入验证码",class:"security-code-input"},null,512),[[o.nr,e.securityCode]]),(0,r._)("img",{src:e.securityCodeUrl,alt:"验证码",onClick:t[4]||(t[4]=function(){return e.refreshSecurityCode&&e.refreshSecurityCode(...arguments)}),class:"captcha-img"},null,8,J),(0,r.wy)((0,r._)("div",{class:"tip4"},(0,m.zw)(e.errors.securityCode),513),[[o.F8,e.securityCodeInvalid]])]),G,(0,r._)("p",null,[(0,r.Uk)("已有账号？去"),(0,r.Wm)(u,{to:"/login",class:"routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)(" 登录")])),_:1})])],32)])])}var X=a(7016),ee=(0,r.aZ)({setup(){const e=(0,W.iH)(""),t=(0,W.iH)(""),a=(0,W.iH)(""),o=(0,W.iH)(""),s=(0,W.iH)(!1),l=new FormData,n={username:"",password:"",confirmPassword:"",securityCode:""},u=(0,W.iH)(""),i=(0,W.iH)(!1),d=(0,W.iH)(!1),c=(0,W.iH)(!1);(0,r.YP)(e,(async e=>{if(""===e.trim())return;const t=e.trim(),a=/^\w{6,20}$/.test(t);if(!a)return n.username="用户名为长度为6-20位的数字和字母的组合",void(i.value=!1);i.value=!0,n.username=""})),(0,r.YP)(t,(e=>{if(""===e.trim())return;const t=e;d.value=!!t&&/^[^\s]*(\s+[^\s]*){0}$/.test(t)&&/(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9])[^\s]{8,16}/.test(t),d.value?(d.value=!0,n.password=""):n.password="密码为8-16位数字、字母和特殊字符（不包括空格）"})),(0,r.YP)(a,(e=>{if(""===e.trim())return;const a=e.trim();c.value=!!a&&a===t.value})),(0,r.YP)([t,a],(e=>{let[t,a]=e;t&&a?c.value=!!t&&t===a:(c.value=!1,n.confirmPassword="两次输入的密码不一致！")}));const m=()=>{U().get("/user/refresh_code").then((e=>{u.value=e.data.image_url,s.value=!1,o.value=""})).catch((e=>{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t})}))},p=()=>{i.value&&d.value&&c.value&&o.value?(l.append("username",e.value),l.append("password",t.value),l.append("code",o.value),U().post("user/register/",l).then((e=>{console.log(e),bt.push("/login")})).catch((e=>{if(e.response){const t=e.response.data.error_msg;(0,X.bM)({type:"warning",message:t})}}))):alert("niubi")};return m(),{username:e,password:t,confirmPassword:a,securityCode:o,errors:n,securityCodeUrl:u,validUsername:i,validPassword:d,validConfirmPassword:c,securityCodeInvalid:s,refreshSecurityCode:m,onSubmit:p}}});const te=(0,u.Z)(ee,[["render",Q],["__scopeId","data-v-ee88959c"]]);var ae=te;function oe(e,t){return(0,r.wg)(),(0,r.iD)("div",null,"使用文档")}const re={},se=(0,u.Z)(re,[["render",oe]]);var le=se;const ne=e=>((0,r.dD)("data-v-99cca2ca"),e=e(),(0,r.Cn)(),e),ue={class:"WorkPage"},ie=ne((()=>(0,r._)("img",{src:p,alt:""},null,-1))),de={class:"username"},ce=ne((()=>(0,r._)("div",{class:"intomain"},null,-1)));function me(e,t,a,o,s,l){const n=(0,r.up)("router-link"),u=(0,r.up)("el-header"),i=(0,r.up)("el-aside"),d=(0,r.up)("router-view"),c=(0,r.up)("el-main"),p=(0,r.up)("el-container");return(0,r.wg)(),(0,r.iD)("div",ue,[(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(n,{to:"/",class:"logo routerlink"},{default:(0,r.w5)((()=>[ie])),_:1}),(0,r.Wm)(n,{to:"/about",class:"about routerlink"},{default:(0,r.w5)((()=>[(0,r.Uk)("使用文档")])),_:1}),(0,r._)("span",de,[(0,r.Uk)("欢迎，"),(0,r._)("span",{onClick:t[0]||(t[0]=function(){return e.handleLogout&&e.handleLogout(...arguments)}),class:"logout"},"hhh"+(0,m.zw)(e.username),1)])])),_:1}),(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{width:"15%"},{default:(0,r.w5)((()=>[(0,r._)("div",{onClick:t[1]||(t[1]=function(){return e.totrain&&e.totrain(...arguments)}),"exact-active-class":"active","active-class":"active"},"训练中心"),(0,r._)("div",{onClick:t[2]||(t[2]=function(){return e.totest&&e.totest(...arguments)}),"exact-active-class":"active","active-class":"active"},"模型预测")])),_:1}),(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[ce,(0,r.Wm)(d)])),_:1})])),_:1})])),_:1})])}a(2801);const pe=U().create({});pe.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Token ${t}`),e}),(e=>Promise.reject(e)));U().create({});const{CancelToken:fe}=U();async function ge(){try{return await pe.post("user/logout/"),localStorage.removeItem("token"),delete pe.defaults.headers.common.Authorization,localStorage.removeItem("username"),!0}catch(e){return console.error(e),!1}}var we=(0,r.aZ)({setup(){const e=localStorage.getItem("username"),t=async()=>{const e=await ge();e?bt.push("./login"):alert("退出失败！请稍后重试！")},a=()=>{bt.push("/TrainModel")},o=()=>{bt.push("/ModelPrediction")};return{username:e,handleLogout:t,totrain:a,totest:o}}});const he=(0,u.Z)(we,[["render",me],["__scopeId","data-v-99cca2ca"]]);var ve=he;const _e=e=>((0,r.dD)("data-v-32288e0a"),e=e(),(0,r.Cn)(),e),ye=_e((()=>(0,r._)("h1",null,"404 Not Found!",-1)));function be(e,t,a,o,s,l){const n=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",null,[ye,(0,r._)("p",null,[(0,r.Uk)((0,m.zw)(e.count)+"秒后将自动跳转至",1),(0,r.Wm)(n,{to:"/"},{default:(0,r.w5)((()=>[(0,r.Uk)("首页")])),_:1})])])}var ke=(0,r.aZ)({setup(){let e=(0,W.iH)(5);const t=setInterval((()=>{e.value--}),1e3);return(0,r.YP)(e,(e=>{0===e&&(clearInterval(t),bt.push("/"))})),{count:e}}});const Ce=(0,u.Z)(ke,[["render",be],["__scopeId","data-v-32288e0a"]]);var We=Ce;const Me=e=>((0,r.dD)("data-v-3ad5d9aa"),e=e(),(0,r.Cn)(),e),Ue={class:"container"},De=Me((()=>(0,r._)("h3",null,"创建新的训练",-1))),Ne={class:"data"},Se=Me((()=>(0,r._)("div",{class:"el-upload__tip"},"支持 .csv 格式文件",-1))),Pe=Me((()=>(0,r._)("h3",{style:{"margin-top":"20px","margin-bottom":"10px"}},"训练进程展示",-1))),Te={key:0},xe={key:1},je={key:2},Ve={key:3},Fe={key:4},Ie={key:0},ze={key:0};function Oe(e,t,a,o,s,l){const n=(0,r.up)("el-button"),u=(0,r.up)("el-upload"),i=(0,r.up)("el-form-item"),d=(0,r.up)("el-form"),c=(0,r.up)("el-radio"),p=(0,r.up)("el-input"),f=(0,r.up)("el-table-column"),g=(0,r.up)("el-table");return(0,r.wg)(),(0,r.iD)("div",Ue,[De,(0,r._)("div",Ne,[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{label:"上传文件"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{ref:"fileUpload","on-change":o.handleFileChange,"show-file-list":!1,"auto-upload":!1,accept:".csv",multiple:!1},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{size:"small",type:"primary",class:"choseFile"},{default:(0,r.w5)((()=>[(0,r.Uk)("选择文件")])),_:1}),Se])),_:1},8,["on-change"])])),_:1})])),_:1}),(0,r.Wm)(d,{model:o.form,ref:"createForm",style:{"max-width":"600px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{label:"选择算法"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.models,(e=>((0,r.wg)(),(0,r.j4)(c,{modelValue:o.form.modelName,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.modelName=e),label:e.name,key:e.name},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(e.name),1)])),_:2},1032,["modelValue","label"])))),128))])),_:1}),(0,r.Wm)(i,{label:"模型名称"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{modelValue:o.form.userModelName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.userModelName=e),placeholder:"请输入模型名称",onBlur:o.checkModelName},null,8,["modelValue","onBlur"])])),_:1}),(0,r.Wm)(i,{label:"特征值数"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{type:"number",modelValue:o.form.featuresNum,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.featuresNum=e),placeholder:"请输入特征值数"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(i,{label:"标签范围"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{type:"number",modelValue:o.form.labelsNum,"onUpdate:modelValue":t[3]||(t[3]=e=>o.form.labelsNum=e),placeholder:"请输入标签范围"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(i,null,{default:(0,r.w5)((()=>[(0,r.Wm)(n,{type:"primary",onClick:o.createTrain},{default:(0,r.w5)((()=>[(0,r.Uk)("确定创建")])),_:1},8,["onClick"]),(0,r.Wm)(n,{onClick:o.cancel},{default:(0,r.w5)((()=>[(0,r.Uk)("取消创建")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),Pe,(0,r.Wm)(g,{data:o.trainTasks,style:{"max-width":"1024px"},"header-cell-style":{backgroundColor:"#f5f7fa"}},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{prop:"name",label:"训练任务"}),(0,r.Wm)(f,{prop:"status",label:"训练状态"},{default:(0,r.w5)((e=>{let{row:t}=e;return[""===t.status?((0,r.wg)(),(0,r.iD)("span",Te,"等待中")):"in_progress"===t.status?((0,r.wg)(),(0,r.iD)("span",xe,"训练中")):"terminated"===t.status?((0,r.wg)(),(0,r.iD)("span",je,"已取消")):"exception"===t.status?((0,r.wg)(),(0,r.iD)("span",Ve,"训练失败")):"success"===t.status?((0,r.wg)(),(0,r.iD)("span",Fe,"已完成")):(0,r.kq)("",!0)]})),_:1}),(0,r.Wm)(f,{prop:"startTime",label:"开始时间"}),(0,r.Wm)(f,{label:"Accuracy"},{default:(0,r.w5)((e=>{let{row:t}=e;return["success"===t.status?((0,r.wg)(),(0,r.iD)("span",Ie,(0,m.zw)(t.accuracy),1)):(0,r.kq)("",!0)]})),_:1}),(0,r.Wm)(f,{label:"MacroF1"},{default:(0,r.w5)((e=>{let{row:t}=e;return["success"===t.status?((0,r.wg)(),(0,r.iD)("span",ze,(0,m.zw)(t.loss),1)):(0,r.kq)("",!0)]})),_:1}),(0,r.Wm)(f,{label:"操作"},{default:(0,r.w5)((e=>{let{row:t}=e;return["success"===t.status?((0,r.wg)(),(0,r.j4)(n,{key:0,type:"primary",href:o.modelURL,onClick:e=>o.downloadModel(t.id)},{default:(0,r.w5)((()=>[(0,r.Uk)("下载模型")])),_:2},1032,["href","onClick"])):(0,r.kq)("",!0)]})),_:1})])),_:1},8,["data"])])}var $e={name:"TrainingPage",setup(){const e=(0,W.qj)([{name:"SVM"},{name:"RandomForest_K"},{name:"CNN"},{name:"SVM_K"}]);let t=new FormData,a=(0,W.qj)([]),o=(0,W.qj)({modelName:"",userModelName:"",featuresNum:"",labelsNum:""}),r=null,s=(0,W.iH)(null);const l=e=>{t.delete("file"),r=e.name,t.append("file",e.raw,e.name),console.log(e.raw)},n=()=>{if(""===o.userModelName)(0,X.bM)({type:"error",message:"模型名不能为空"});else if(!/^\w{6,20}$/.test(o.userModelName))return void(0,X.bM)({type:"error",message:"模型名称由6-20位字母数字组成"})},u=()=>{const e=new Date,t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),s=`${t}-${a} ${o}:${r}`;return s.toString()},i=()=>{if(""===o.modelName||""===o.userModelName||""===o.featuresNum||""===o.labelsNum||!r)return void(0,X.bM)({type:"error",message:"请填写完整的训练任务信息"});a.unshift({id:null,name:o.userModelName,status:"in_progress",startTime:u(),accuracy:0,loss:0}),console.log(a);const e=u();t.append("create_time",e),t.append("algorithm",o.modelName),t.append("model_name",o.userModelName),t.append("featuresNum",o.featuresNum),t.append("labelsNum",o.labelsNum),console.log(t.get("file")),pe.post("upload/train/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{d(),console.log("--------------------------","yes,train了"),(0,X.bM)({type:"success",message:"创建训练任务成功"});const t=e.data;a.push({id:t.id,name:t.model_name,status:"in_progress",startTime:t.create_time,accuracy:0,loss:0}),o.userModelName="",o.featuresNum="",o.labelsNum="",o.modelName="",r="";const{fileUpload:s}=this.$refs;s&&s.clearFiles()})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t}),console.error(e)}})).finally((()=>{t.delete("name"),t.delete("file"),t.delete("algorithm"),t.delete("featuresNum"),t.delete("labelsNum"),r=""}))},d=()=>{pe.get("upload/find_train/").then((e=>{a=[];const t=e.data;t.forEach((e=>{const t={id:e.train_id,name:e.model_name,status:e.status,startTime:e.create_time,accuracy:e.Accuracy,loss:e.MacroF1};a.push(t)}))})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t}),console.error(e)}}))},c=()=>{if(o.userModelName="",o.featuresNum="",o.labelsNum="",o.modelName="",r="",t.delete("file"),s.value){const{fileUpload:e}=s.value;e&&e.clearFiles()}},m=(0,W.iH)(""),p=e=>{const t=new FormData;t.append("taskid",e),pe.post("/upload/model_download/",t).then((e=>{m.value=e.data;const t=document.createElement("a");t.href=m.value,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t})}}))};return d(),{models:e,formData:t,downloadModel:p,modelURL:m,trainTasks:a,form:o,fileUploadRef:s,handleFileChange:l,createTrain:i,getTrainTasks:d,cancel:c,checkModelName:n}}};const He=(0,u.Z)($e,[["render",Oe],["__scopeId","data-v-3ad5d9aa"]]);var Ze=He;const qe=e=>((0,r.dD)("data-v-55cdb765"),e=e(),(0,r.Cn)(),e),Re={class:"container"},Le=qe((()=>(0,r._)("h3",null,"开始预测",-1))),Ae={class:"data"},Be=qe((()=>(0,r._)("div",{class:"el-upload__tip"},"支持 .csv 格式文件",-1))),Ye={class:"modelCard"},Ee={class:"choseModel"},Ke=qe((()=>(0,r._)("span",{style:{"font-size":"14px",color:"var(--el-text-color-regular)","margin-right":"12px"}},"选择模型",-1))),Je={key:0,class:"showModel"},Ge={class:"card-item"},Qe={class:"card-content-item"},Xe=qe((()=>(0,r._)("h3",{style:{"margin-top":"20px","margin-bottom":"10px"}},"测试结果",-1))),et={key:0},tt={key:1},at={key:2},ot={key:3},rt={key:4};function st(e,t,a,o,s,l){const n=(0,r.up)("el-button"),u=(0,r.up)("el-upload"),i=(0,r.up)("el-form-item"),d=(0,r.up)("el-form"),c=(0,r.up)("el-option"),p=(0,r.up)("el-select"),f=(0,r.up)("el-card"),g=(0,r.up)("el-input"),w=(0,r.up)("el-table-column"),h=(0,r.up)("el-table");return(0,r.wg)(),(0,r.iD)("div",Re,[Le,(0,r._)("div",Ae,[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{label:"上传文件"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{ref:"fileUpload","on-change":o.handleFileChange,"show-file-list":!1,"auto-upload":!1,accept:".csv",multiple:!1},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{size:"small",type:"primary",class:"choseFile"},{default:(0,r.w5)((()=>[(0,r.Uk)("选择文件")])),_:1}),Be])),_:1},8,["on-change"])])),_:1})])),_:1}),(0,r._)("div",Ye,[(0,r._)("div",Ee,[Ke,(0,r.Wm)(p,{label:"选择模型",modelValue:o.form.modelid,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.modelid=e),onChange:t[1]||(t[1]=e=>o.handleModelChange(o.form.modelid))},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.models,(e=>((0,r.wg)(),(0,r.j4)(c,{value:e.id,label:e.name,key:e.id},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(e.name),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue"])]),0!==Object.keys(o.selectedModel).length?((0,r.wg)(),(0,r.iD)("div",Je,[(0,r.Wm)(f,{shadow:"hover"},{default:(0,r.w5)((()=>[(0,r._)("div",Ge,[(0,r._)("div",null,"模型名称："+(0,m.zw)(o.selectedModel.name),1),(0,r._)("div",Qe,"特征值数: "+(0,m.zw)(o.selectedModel.featuresNum),1)])])),_:1})])):(0,r.kq)("",!0)]),(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{label:"特征值数"},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{type:"number",modelValue:o.form.featuresNum,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.featuresNum=e),placeholder:"请输入特征值数",style:{width:"215px"}},null,8,["modelValue"])])),_:1}),(0,r.Wm)(i,null,{default:(0,r.w5)((()=>[(0,r.Wm)(n,{type:"primary",onClick:o.createPrediction},{default:(0,r.w5)((()=>[(0,r.Uk)("确定创建")])),_:1},8,["onClick"]),(0,r.Wm)(n,{onClick:o.cancel},{default:(0,r.w5)((()=>[(0,r.Uk)("取消创建")])),_:1},8,["onClick"])])),_:1})])),_:1})]),Xe,(0,r.Wm)(h,{data:o.predictionTasks,style:{"max-width":"1024px"},"header-cell-style":{backgroundColor:"#f5f7fa"}},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{prop:"name",label:"预测任务"}),(0,r.Wm)(w,{prop:"status",label:"预测状态"},{default:(0,r.w5)((e=>{let{row:t}=e;return[""===t.status?((0,r.wg)(),(0,r.iD)("span",et,"等待中")):"in_progress"===t.status?((0,r.wg)(),(0,r.iD)("span",tt,"预测中")):"terminated"===t.status?((0,r.wg)(),(0,r.iD)("span",at,"已取消")):"exception"===t.status?((0,r.wg)(),(0,r.iD)("span",ot,"预测失败")):"success"===t.status?((0,r.wg)(),(0,r.iD)("span",rt,"已完成")):(0,r.kq)("",!0)]})),_:1}),(0,r.Wm)(w,{prop:"startTime",label:"开始时间"}),(0,r.Wm)(w,{label:"操作"},{default:(0,r.w5)((e=>{let{row:t}=e;return["success"===t.status?((0,r.wg)(),(0,r.j4)(n,{key:0,type:"primary",onClick:e=>o.showCharts(t.id)},{default:(0,r.w5)((()=>[(0,r.Uk)("可视化展示")])),_:2},1032,["onClick"])):(0,r.kq)("",!0)]})),_:1})])),_:1},8,["data"])])}var lt={setup(){let e=(0,W.qj)([]),t=new FormData,a=(0,W.qj)([]),o=(0,W.qj)({modelid:"",featuresNum:""}),r=(0,W.iH)({});const s=()=>{pe.get("upload/find_model/").then((t=>{const a=t.data;console.log(a),e=a.map((e=>({id:e.model_id,name:e.model_name,featuresNum:e.featuresNum}))),console.log("------------------------",e)})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t}),console.error(e)}}))};function l(t){r.value=e.find((e=>e.id===t))}const n=e=>{bt.push({path:`/ResultsPage/${e}`})};let u=null,i=(0,W.iH)(null);const d=e=>{t.delete("file"),u=e.name,t.append("file",e.raw,e.name),console.log(e.raw)},c=()=>{const e=new Date,t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),s=`${t}-${a} ${o}:${r}`;return s.toString()},m=()=>{if(""===o.modelid||""===o.featuresNum||!u)return void(0,X.bM)({type:"error",message:"请填写完整的训练任务信息"});t.append("model_id",o.modelid),t.append("featuresNum",o.featuresNum),console.log(t.get("file")),p(),a.unshift({id:null,name:u,status:"in_progress",startTime:c()});const e=c();t.append("create_time",e),pe.post("upload/test/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{p(),(0,X.bM)({type:"success",message:"创建预测任务成功"});const t=e.data.tasks;a.push({id:t.id,name:u,status:"in_progress",startTime:t.create_time}),i.value.clearFiles(),o.featuresNum="",o.modelid="",u="",r.value={};const{fileUpload:s}=this.$refs;s&&s.clearFiles()})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t}),console.error(e)}})).finally((()=>{t.delete("model_id"),t.delete("file"),t.delete("featuresNum"),u=""}))},p=()=>{pe.get("upload/find_test/").then((e=>{a=[];const t=e.data;t.forEach((e=>{const t={id:e.test_id,name:e.name,status:e.status,startTime:e.create_time};a.push(t)}))})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t}),console.error(e)}}))},f=()=>{o.modelid="",o.featuresNum="",r.value={},i.value.clearFiles(),u="",t.delete("file")};return s(),p(),{models:e,formData:t,predictionTasks:a,fileUploadRef:i,form:o,selectedModel:r,showCharts:n,handleFileChange:d,handleModelChange:l,createPrediction:m,getPredictionTasks:p,cancel:f}}};const nt=(0,u.Z)(lt,[["render",st],["__scopeId","data-v-55cdb765"]]);var ut=nt;const it={class:"container"},dt={class:"download-btns"},ct={class:"show"},mt={class:"table-container"},pt={ref:"pieCanvas",class:"pieCanvas"};function ft(e,t,a,o,s,l){const n=(0,r.up)("el-button"),u=(0,r.up)("el-table-column"),i=(0,r.up)("el-table");return(0,r.wg)(),(0,r.iD)("div",it,[(0,r._)("div",dt,[(0,r.Wm)(n,{type:"primary",onClick:l.downloadTableData},{default:(0,r.w5)((()=>[(0,r.Uk)(" 下载结果 ")])),_:1},8,["onClick"]),(0,r.Wm)(n,{type:"primary",onClick:l.downloadPieChart,style:{"margin-left":"65px"}},{default:(0,r.w5)((()=>[(0,r.Uk)(" 下载图形 ")])),_:1},8,["onClick"])]),(0,r._)("div",ct,[(0,r._)("div",mt,[(0,r.Wm)(i,{data:s.tableData,class:"table"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{prop:"sampleId",label:"Sample Id"}),(0,r.Wm)(u,{prop:"label",label:"Label"})])),_:1},8,["data"])]),(0,r._)("canvas",pt,null,512)])])}a(2062),a(1439),a(7585),a(5315);var gt=a(2305),wt={name:"MyComponent",props:["id"],data(){return{tableData:[],pieChartData:[],pieChart:null}},mounted(){const e=new FormData;e.append("taskid",this.id),this.$nextTick((()=>{this.$refs.pieCanvas&&this.renderPieChart()})),pe.post("/upload/result_download/",e).then((e=>{const t=e.data,a=Object.entries(t[0]).map((e=>{let[t,a]=e;return{sampleId:t,label:a}})),o=Object.entries(t[0]).map((e=>{let[t,a]=e;return{label:t,value:a}}));this.tableData=a,this.pieChartData=o})).catch((e=>{const t=e.response.status;if(401===t)(0,X.bM)({type:"error",message:"未校验，请重新登录！"}),bt.push("/login");else{const t=e.response.data.error_msg;(0,X.bM)({type:"error",message:t})}}))},methods:{renderPieChart(){if(!this.$refs.pieCanvas)return;this.pieChart=gt.S1(this.$refs.pieCanvas,null,{devicePixelRatio:2});const e=this.pieChartData.map((e=>({value:e.value,name:e.label}))),t={grid:{width:"60%",height:"60%",left:"center"},series:[{type:"pie",data:e,label:{show:!0,formatter:"{b}: {c}",textStyle:{fontSize:14}},emphasis:{label:{show:!0,textStyle:{fontSize:1}}}}]};this.pieChart.setOption(t)},downloadTableData(){const e=this.arrayToCSV(this.tableData),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="table-data.csv",a.click()},downloadPieChart(){if(!this.$refs.pieCanvas)return;const e=this.$refs.pieCanvas.toDataURL("image/png"),t=this.dataURItoBlob(e),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="pie-chart.png",a.click()},dataURItoBlob(e){const t=atob(e.split(",")[1]),a=[];for(let r=0;r<t.length;r++)a.push(t.charCodeAt(r));const o=e.split(",")[0].split(":")[1].split(";")[0];return new Blob([new Uint8Array(a)],{type:o})},arrayToCSV(e){const t=[],a=Object.keys(e[0]);t.push(a.join(","));for(const o of e){const e=a.map((e=>{const t=null===o[e]||void 0===o[e]?"":o[e];return JSON.stringify(t)}));t.push(e.join(","))}return t.join("\n")}}};const ht=(0,u.Z)(wt,[["render",ft],["__scopeId","data-v-01a3a3f4"]]);var vt=ht;const _t=[{path:"/:pathMatch(.*)*",component:We},{path:"/login",component:S},{path:"/",component:H},{path:"/register",component:ae},{path:"/about",component:le},{path:"/workspace",component:ve,children:[{path:"/TrainModel",component:Ze},{path:"/ResultsPage/:taskId",component:vt,props:!0},{path:"/ModelPrediction",component:ut}]}],yt=(0,c.p7)({history:(0,c.PO)("/"),routes:_t});var bt=yt,kt=a(502);a(2834);const Ct=localStorage.getItem("token");pe.defaults.headers.common.Authorization=Ct?`Bearer ${Ct}`:"",(0,o.ri)(d).use(bt).use(kt.Z).mount("#app")}},t={};function a(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,o,r,s){if(!o){var l=1/0;for(d=0;d<e.length;d++){o=e[d][0],r=e[d][1],s=e[d][2];for(var n=!0,u=0;u<o.length;u++)(!1&s||l>=s)&&Object.keys(a.O).every((function(e){return a.O[e](o[u])}))?o.splice(u--,1):(n=!1,s<l&&(l=s));if(n){e.splice(d--,1);var i=r();void 0!==i&&(t=i)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,r,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,s,l=o[0],n=o[1],u=o[2],i=0;if(l.some((function(t){return 0!==e[t]}))){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(u)var d=u(a)}for(t&&t(o);i<l.length;i++)s=l[i],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},o=self["webpackChunkfaultc"]=self["webpackChunkfaultc"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(1369)}));o=a.O(o)})();
//# sourceMappingURL=app.a5c7cc09.js.map